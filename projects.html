---
layout: default
title: projects
permalink: /projects.html
---
<!-- ===== Gold Interactive Banner (Hearts/Clubs/Spades/Diamonds) ===== -->
<section class="max-w-7xl mx-auto px-4 mt-6">
  <style>
    :root {
      --gold: rgb(214, 177, 77);
      --gold-mid: rgb(234, 197, 97);
      --gold-dark: rgb(194, 157, 57);
      --government-gold: rgb(214, 177, 77);
      --industry-red: rgb(172, 14, 14);
      --academic-black: #111827;
      --ongoing-black: #111827;
      --completed-gray: #9ca3af;
    }

    /* Banner */
    .banner-section {
      background: linear-gradient(
        135deg,
        var(--gold) 0%,
        var(--gold-mid) 25%,
        var(--gold-dark) 50%,
        var(--gold) 75%,
        var(--gold-mid) 100%
      );
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
      position: relative;
      overflow: hidden;
      min-height: 200px;
      border-radius: 1rem;
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      cursor: pointer;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Burst container */
    .network-burst {
      position: absolute;
      width: 200px;
      height: 200px;
      pointer-events: none;
      opacity: 0;
      animation: burstAnimation 2s ease-out forwards;
    }
    @keyframes burstAnimation {
      0%   { opacity: 0; transform: scale(.3) rotate(0deg); }
      30%  { opacity: .85; }
      100% { opacity: 0; transform: scale(2) rotate(180deg); }
    }
    .network-burst svg { width: 100%; height: 100%; }
    .burst-line { stroke: rgba(255,255,255,.8); stroke-width: 1.5; fill: none; }
    .burst-dot  { fill: rgba(255,255,255,.95); }

    /* Banner content (left-bottom) */
    .banner-content {
      position: relative;
      z-index: 10;
      padding: 32px 24px;
      display: flex;
      align-items: flex-end;
      justify-content: flex-start;
      min-height: 200px;
      word-break: keep-all;
      overflow-wrap: break-word;
    }
   .breadcrumbs-banner {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 16px;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  padding: 10px 16px;
  border-radius: 999px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 3px rgba(255,255,255,0.5);
  border: 1px solid rgba(214, 177, 77, 0.2);
  transition: all 0.3s ease;
}

.breadcrumbs-banner:hover {
  background: rgba(255, 255, 255, 1);
  box-shadow: 0 6px 20px rgba(0,0,0,0.12), inset 0 1px 3px rgba(255,255,255,0.8);
  transform: translateY(-1px);
}

.breadcrumbs-banner a {
  color: var(--gold-dark);
  text-decoration: none;
  transition: all 0.2s;
  position: relative;
  font-weight: 600;
}

.breadcrumbs-banner a:hover {
  color: var(--gold);
  text-shadow: 0 0 8px rgba(214, 177, 77, 0.3);
}

.breadcrumbs-banner a::after {
  content: '';
  position: absolute;
  bottom: -2px;
  left: 0;
  width: 0;
  height: 1px;
  background: var(--gold);
  transition: width 0.2s ease;
}

.breadcrumbs-banner a:hover::after {
  width: 100%;
}

.breadcrumbs-banner .sep {
  color: var(--gold-light);
  font-weight: 400;
  margin: 0;
  opacity: 0.6;
}

.breadcrumbs-banner span:not(.sep):not(a) {
  color: var(--gold);
  font-weight: 800;
  letter-spacing: 0.3px;
}

/* Breadcrumb ÏïÑÏù¥ÏΩò Ï∂îÍ∞Ä */
.breadcrumbs-banner::before {
  content: 'üìä';
  font-size: 14px;
  margin-right: 2px;
  opacity: 0.8;
}

    .banner-title {
      font-size: 2.25rem;
      font-weight: 900;
      color: #fff;
      text-shadow: 0 2px 4px rgba(0,0,0,.12);
      letter-spacing: -.02em;
      margin: 0;
      word-break: keep-all;
      overflow-wrap: break-word;
    }

/* Responsive */
@media (max-width: 768px) {
  .banner-content { padding: 24px 18px; min-height: 160px; }
  .banner-section { min-height: 160px; }
  .banner-title { font-size: 1.9rem; }
  .breadcrumbs-banner { 
    font-size: 12px;
    padding: 8px 14px;
    gap: 0.6rem;
  }
  .breadcrumbs-banner::before {
    font-size: 12px;
  }
}
@media (max-width: 480px) {
  .banner-content { padding: 20px 16px; min-height: 130px; }
  .banner-section { min-height: 130px; }
  .banner-title { font-size: 1.6rem; }
  .breadcrumbs-banner { 
    font-size: 10px;
    gap: 0.4rem;
    padding: 6px 10px;
  }
  .breadcrumbs-banner::before {
    display: none;
  }
}
  </style>

  <div class="banner-section" onclick="createNetworkBurst(event, this)">
    <div class="banner-content">
      <div>
        <nav aria-label="Breadcrumb" class="breadcrumbs-banner" onclick="event.stopPropagation()">
          <a href="{{ '/' | relative_url }}">Home</a>
          <span class="sep">‚Ä∫</span>
          <span aria-current="page">Projects</span>
        </nav>
        <h1 class="banner-title">Projects</h1>
      </div>
    </div>
  </div>
</section>

<script>
/* Interactive gold burst (cards suits) */
function createNetworkBurst(event, element) {
  const rect = element.getBoundingClientRect();
  const x = event.clientX - rect.left - 100;
  const y = event.clientY - rect.top  - 100;

  const networkDiv = document.createElement('div');
  networkDiv.className = 'network-burst';
  networkDiv.style.left = x + 'px';
  networkDiv.style.top  = y + 'px';

  const patterns = [generateHeartNetwork, generateClubNetwork, generateSpadeNetwork, generateDiamondNetwork];
  const randomPattern = patterns[Math.floor(Math.random() * patterns.length)];
  networkDiv.innerHTML = randomPattern();

  element.appendChild(networkDiv);
  setTimeout(()=> element.removeChild(networkDiv), 2000);
}

/* Heart */
function generateHeartNetwork() {
  let svg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">';
  const heartPath = 'M100,140 C80,120 40,100 40,70 C40,50 55,35 70,35 C85,35 95,45 100,55 C105,45 115,35 130,35 C145,35 160,50 160,70 C160,100 120,120 100,140 Z';
  svg += `<path d="${heartPath}" class="burst-line" stroke-width="2"/>`;
  const nodes = [
    {x:70,y:35},{x:130,y:35},
    {x:40,y:70},{x:160,y:70},
    {x:100,y:140},{x:60,y:50},{x:140,y:50},{x:80,y:90},{x:120,y:90}
  ];
  const connections = [[0,1],[0,2],[1,3],[2,4],[3,4],[0,5],[1,6],[5,7],[6,8],[7,8]];
  connections.forEach(([f,t])=> svg += `<line x1="${nodes[f].x}" y1="${nodes[f].y}" x2="${nodes[t].x}" y2="${nodes[t].y}" class="burst-line" opacity=".5"/>`);
  nodes.forEach(n=> svg += `<circle cx="${n.x}" cy="${n.y}" r="${3 + Math.random()*2}" class="burst-dot"/>`);
  svg += '</svg>'; return svg;
}
/* Club */
function generateClubNetwork() {
  let svg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">';
  const circles = [{x:100,y:60,r:25},{x:75,y:85,r:25},{x:125,y:85,r:25}];
  circles.forEach(c=> svg += `<circle cx="${c.x}" cy="${c.y}" r="${c.r}" class="burst-line" stroke-width="2"/>`);
  svg += `<line x1="100" y1="100" x2="100" y2="140" class="burst-line" stroke-width="3"/>`;
  const nodes=[];
  circles.forEach(c=>{
    for(let i=0;i<6;i++){ const a=i*2*Math.PI/6; nodes.push({x:c.x+c.r*Math.cos(a),y:c.y+c.r*Math.sin(a)}); }
  });
  nodes.push({x:100,y:100},{x:100,y:140});
  for(let i=0;i<nodes.length;i++){
    for(let j=i+1;j<nodes.length;j++){
      const dx=nodes[i].x-nodes[j].x, dy=nodes[i].y-nodes[j].y, d=Math.hypot(dx,dy);
      if(d<40){ svg += `<line x1="${nodes[i].x}" y1="${nodes[i].y}" x2="${nodes[j].x}" y2="${nodes[j].y}" class="burst-line" opacity="${0.3+(1-d/40)*0.4}"/>`; }
    }
  }
  nodes.forEach(n=> svg += `<circle cx="${n.x}" cy="${n.y}" r="${2 + Math.random()*2}" class="burst-dot"/>`);
  svg += '</svg>'; return svg;
}
/* Spade */
function generateSpadeNetwork() {
  let svg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">';
  const spadePath='M100,50 C80,50 60,65 60,85 C60,105 75,110 85,110 C90,110 95,108 100,105 C105,108 110,110 115,110 C125,110 140,105 140,85 C140,65 120,50 100,50 Z';
  svg += `<path d="${spadePath}" class="burst-line" stroke-width="2"/>`;
  svg += `<path d="M100,105 L90,130 L110,130 Z" class="burst-line" stroke-width="2"/>`;
  svg += `<line x1="100" y1="130" x2="100" y2="145" class="burst-line" stroke-width="3"/>`;
  const nodes=[{x:100,y:50},{x:75,y:70},{x:125,y:70},{x:60,y:85},{x:140,y:85},{x:85,y:110},{x:115,y:110},{x:100,y:105},{x:90,y:130},{x:110,y:130},{x:100,y:145}];
  const conn=[[0,1],[0,2],[1,3],[2,4],[3,5],[4,6],[5,7],[6,7],[7,8],[7,9],[8,10],[9,10]];
  conn.forEach(([f,t])=> svg += `<line x1="${nodes[f].x}" y1="${nodes[f].y}" x2="${nodes[t].x}" y2="${nodes[t].y}" class="burst-line" opacity=".4"/>`);
  nodes.forEach((n,i)=> svg += `<circle cx="${n.x}" cy="${n.y}" r="${(i===0||i===7)?4:3}" class="burst-dot"/>`);
  svg += '</svg>'; return svg;
}
/* Diamond */
function generateDiamondNetwork() {
  let svg='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">';
  const diamond='M100,40 L140,100 L100,160 L60,100 Z';
  svg += `<path d="${diamond}" class="burst-line" stroke-width="2"/>`;
  svg += `<line x1="100" y1="40" x2="100" y2="160" class="burst-line" opacity=".55"/>`;
  svg += `<line x1="60" y1="100" x2="140" y2="100" class="burst-line" opacity=".55"/>`;
  svg += `<line x1="80" y1="70" x2="120" y2="130" class="burst-line" opacity=".3"/>`;
  svg += `<line x1="120" y1="70" x2="80" y2="130" class="burst-line" opacity=".3"/>`;
  const nodes=[{x:100,y:40},{x:140,y:100},{x:100,y:160},{x:60,y:100},{x:100,y:100},{x:80,y:70},{x:120,y:70},{x:80,y:130},{x:120,y:130},{x:120,y:100},{x:80,y:100}];
  for(let i=0;i<4;i++){ svg += `<line x1="${nodes[i].x}" y1="${nodes[i].y}" x2="${nodes[4].x}" y2="${nodes[4].y}" class="burst-line" opacity=".32"/>`; }
  nodes.forEach((n,i)=> svg += `<circle cx="${n.x}" cy="${n.y}" r="${i<4?4:(i===4?5:2.5)}" class="burst-dot" opacity="${i===4?1:.85}"/>`);
  for(let i=0;i<4;i++){ const a=i*Math.PI/2; const x=100+30*Math.cos(a), y=100+30*Math.sin(a); svg += `<circle cx="${x}" cy="${y}" r="1.5" class="burst-dot" opacity=".65"/>`; }
  svg += '</svg>'; return svg;
}
</script>

<!-- ===== Statistics Section ===== -->
<section class="max-w-7xl mx-auto px-4 mt-6">
  <style>
    .stats-container {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      padding: 20px;
      text-align: center;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
    }
    
    .stat-card.government-stat::before {
      background: linear-gradient(135deg, rgb(214, 177, 77), rgb(234, 197, 97));
    }
    
    .stat-card.industry-stat::before {
      background: linear-gradient(135deg, rgb(172, 14, 14), rgb(200, 40, 40));
    }
    
    .stat-card.academic-stat::before {
      background: linear-gradient(135deg, #111827, #374151);
    }
    
    .stat-card.total-stat::before {
      background: linear-gradient(135deg, #e5e7eb, #9ca3af);
    }
    
    .stat-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    
    .stat-number {
      font-size: 32px;
      font-weight: 900;
      color: #111827;
      line-height: 1.2;
    }
    
    .stat-label {
      font-size: 12px;
      color: #6b7280;
      margin-top: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 700;
    }
    
    .stat-card.government-stat .stat-number {
      color: rgb(194, 157, 57);
    }
    
    .stat-card.industry-stat .stat-number {
      color: rgb(172, 14, 14);
    }
    
    .stat-card.academic-stat .stat-number {
      color: #111827;
    }
    
    .stat-card.total-stat .stat-number {
      color: #374151;
    }
    
    /* Tablet */
    @media (max-width: 768px) {
      .stats-container {
        grid-template-columns: repeat(4, 1fr);
        gap: 12px;
      }
      .stat-card {
        padding: 16px;
      }
      .stat-number {
        font-size: 26px;
      }
      .stat-label {
        font-size: 10px;
      }
    }
    
    /* Mobile: 3 + 1 layout */
    @media (max-width: 480px) {
      .stats-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(2, auto);
        gap: 10px;
      }
      
      /* Total Projects spans all 3 columns on second row */
      .stat-card.total-stat {
        grid-column: 1 / span 3;
      }
      
      .stat-card {
        padding: 14px;
      }
      .stat-number {
        font-size: 22px;
      }
      .stat-label {
        font-size: 9px;
        letter-spacing: 0.3px;
      }
    }
  </style>
  
  <div class="stats-container">
    <div class="stat-card government-stat">
      <div class="stat-number" id="governmentCount">0</div>
      <div class="stat-label">Government</div>
    </div>
    <div class="stat-card industry-stat">
      <div class="stat-number" id="industryCount">0</div>
      <div class="stat-label">Industry</div>
    </div>
    <div class="stat-card academic-stat">
      <div class="stat-number" id="academicCount">0</div>
      <div class="stat-label">Academic</div>
    </div>
    <div class="stat-card total-stat">
      <div class="stat-number" id="totalCount">0</div>
      <div class="stat-label">Total Projects</div>
    </div>
  </div>
</section>

<!-- ===== Styles ===== -->
<style>
  /* Toolbar */
  .toolbar{display:flex;flex-direction:column;gap:14px;background:#f8fafc;border:1px solid #e5e7eb;border-radius:1rem;padding:16px;margin-top:20px}
  .search-container{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
  .search{flex:1;min-width:0}
  .search input{width:100%;border:1px solid #e5e7eb;border-radius:.6rem;padding:.6rem .8rem;font-size:14px;box-sizing:border-box}

  /* Filter Section */
  .filter-section{margin-top:8px}
  .filter-label{font-size:12px;font-weight:700;color:#6b7280;text-transform:uppercase;letter-spacing:.5px;margin-bottom:8px;display:block}
  .chips{display:flex;flex-wrap:wrap;gap:8px}

  /* Filter Chips */
  .chip{padding:.5rem 1rem;border-radius:999px;border:1px solid transparent;background:#fff;font-weight:700;font-size:12px;cursor:pointer;transition:all .2s;text-transform:uppercase;letter-spacing:.3px}
  .chip:hover{transform:translateY(-1px);box-shadow:0 2px 8px rgba(0,0,0,.1)}
  .chip.is-on{box-shadow:inset 0 0 0 2px #111827}
  .chip:focus-visible{outline:2px solid #111827;outline-offset:2px}

  /* Grid: one project per row */
  .grid{display:grid;gap:14px;margin-top:14px;grid-template-columns:1fr}

  /* Card (outer tint = type color) */
  .card{border-radius:1rem;overflow:hidden;display:block}

  .card.card--government-ongoing{background:rgba(214, 177, 77, 0.18) !important}
  .card.card--industry-ongoing{background:rgba(172, 14, 14, 0.14) !important}
  .card.card--academic-ongoing{background:rgba(255, 255, 255, 0.95) !important}
  .card.card--completed{background:#ffffff}

  .card.card--government-ongoing .inner{border-color: rgba(214, 177, 77, 0.35)}
  .card.card--industry-ongoing .inner{border-color: rgba(172, 14, 14, 0.28)}
  .card.card--academic-ongoing .inner{border-color: rgba(17, 24, 39, 0.25)}

  .inner{position:relative;background:#fff;border-radius:.9rem;margin:10px;overflow:hidden;border:1px solid #e5e7eb;transition:border-color .2s, box-shadow .2s}
  .card:hover .inner{box-shadow:0 6px 20px rgba(0,0,0,.06)}

  .type-notch{position:absolute;left:12px;top:12px;bottom:12px;width:8px;border-radius:8px;background:#ddd}

  .body{padding:16px 20px 16px 48px}

  .badges-status{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px}
  .badges-keywords{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:10px}

  .badge{display:inline-block;padding:.25rem .6rem;border-radius:999px;font-weight:800;font-size:11px;background:#f8fafc;border:1px solid #e5e7eb;text-transform:uppercase;white-space:nowrap}

  .project-title-en{font-size:16px;font-weight:900;color:#111827;margin-top:8px;word-break:keep-all;overflow-wrap:break-word}
  .project-title-ko{font-size:14px;color:#6b7280;margin-top:4px;word-break:keep-all;overflow-wrap:break-word}

  /* Desktop optimized meta-info */
  .meta-info{
    display:grid;
    grid-template-columns:max-content minmax(0, 1fr);
    column-gap:16px;
    row-gap:10px;
    margin-top:14px;
    padding-top:14px;
    border-top:1px solid #f3f4f6
  }
  .meta-item{display:contents;font-size:12px}
  .meta-label{font-weight:800;color:#374151;font-size:12px;line-height:1.6;white-space:nowrap}
  .meta-value{color:#111827;font-size:12px;line-height:1.6;word-break:keep-all;overflow-wrap:break-word}

  .ko-muted{color:#9ca3af}

  .empty{padding:32px;text-align:center;color:#6b7280;font-weight:700;border:1px dashed #e5e7eb;border-radius:1rem;background:#fff}
  .count{font-size:13px;color:#6b7280;font-weight:600;background:#fff;padding:.4rem .8rem;border:1px solid #e5e7eb;border-radius:.5rem;white-space:nowrap}

  /* Mobile specific styles */
  @media (max-width:640px){
    .search-container{flex-direction:column;align-items:stretch}
    .search{width:100%}
    .count{text-align:center;width:100%}

    .body{padding:12px 14px 12px 40px}

    .meta-info{
      grid-template-columns:max-content 1fr;
      column-gap:8px;
      row-gap:6px;
    }
    .meta-label{font-size:9px}
    .meta-value{font-size:9px}
    .project-title-en{font-size:12px}
    .project-title-ko{font-size:10px}
    .badge{font-size:9px;padding:.18rem .4rem}
    .chip{font-size:10px;padding:.35rem .7rem}
    
    .type-notch{width:6px;left:10px;top:10px;bottom:10px}
  }
</style>

<!-- ===== Toolbar (Search + Filters) ===== -->
<section class="max-w-7xl mx-auto px-4">
  <div class="toolbar">
    <div class="search-container">
      <div class="search">
        <input id="q" type="text" placeholder="Search projects..." />
      </div>
      <div class="count" id="count"></div>
    </div>
  </div>
</section>

<section class="max-w-7xl mx-auto px-4">
  <div class="toolbar" style="padding: 0;">
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 16px; background: #f8fafc; border-radius: 1rem 1rem 0 0; border-bottom: 1px solid #e5e7eb;">
      <h3 style="font-size: 14px; font-weight: 800; color: #111827; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">Filters</h3>
      <button id="toggleFilters" style="padding: .4rem .8rem; border: 1px solid #e5e7eb; border-radius: .6rem; font-size: 12px; font-weight: 700; background: #fff; cursor: pointer; color: #374151; transition: all .2s;" onmouseover="this.style.background='#f3f4f6'" onmouseout="this.style.background='#fff'">Expand</button>
    </div>
    
<div id="filterContent" style="display: none; padding: 16px;">
  <button id="clearAllFilters" style="width: 100%; padding: .5rem 1rem; border: 2px solid rgb(214, 177, 77); border-radius: .6rem; font-size: 12px; font-weight: 800; background: rgba(214, 177, 77, 0.1); cursor: pointer; color: rgb(194, 157, 57); transition: all .2s; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.5px;" onmouseover="this.style.background='rgba(214, 177, 77, 0.2)'" onmouseout="this.style.background='rgba(214, 177, 77, 0.1)'">Clear all filters</button>
  
  <div class="filter-section">
    <label class="filter-label">Funding Type</label>
    <div class="chips" id="fundingChips"></div>
  </div>

  <div class="filter-section">
    <label class="filter-label">Project Status</label>
    <div class="chips" id="statusChips"></div>
  </div>
</div>
  </div>
</section>

<!-- ===== Content ===== -->
<section class="max-w-7xl mx-auto px-4 pb-8">
  <div class="grid" id="grid"></div>
</section>

<script>
(() => {
  /* ===== Raw Data from _data/projects.json via Liquid ===== */
  const PROJECTS = {{ site.data.projects | jsonify }};

  /* ===== Filters ===== */
  const FUNDING_TYPES = [
    { value: "government", label: "Government-Funded", color: "rgb(214, 177, 77)" },
    { value: "industry", label: "Industry-Funded", color: "rgb(172, 14, 14)" },
    { value: "academic", label: "Academic", color: "#111827" }
  ];

  const STATUSES = [
    { value: "ongoing", label: "Ongoing", color: "#111827" },
    { value: "completed", label: "Completed", color: "#9ca3af" }
  ];

  const onFunding = new Set();
  const onStatus = new Set();

  /* ===== Utils ===== */
  function parseStartDate(period){
    const m = period.match(/^(\d{4})-(\d{2})-(\d{2})/);
    return m ? new Date(`${m[1]}-${m[2]}-${m[3]}T00:00:00`) : new Date(0);
  }

  function parseEndDate(period){
    const m = period.match(/‚Äì\s*(\d{4})-(\d{2})-(\d{2})$/);
    return m ? new Date(`${m[1]}-${m[2]}-${m[3]}T23:59:59`) : new Date(0);
  }

  function computeStatus(period){
    const end = parseEndDate(period);
    const today = new Date();
    return (end.getTime() >= today.getTime()) ? "ongoing" : "completed";
  }

  function formatPeriod(period){
    const parts = period.split(' ‚Äì ');
    if(parts.length !== 2) return period;
    const startDate = new Date(parts[0]);
    const endDate = new Date(parts[1]);
    const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    const startStr = `${months[startDate.getMonth()]} ${startDate.getFullYear()}`;
    const endStr = `${months[endDate.getMonth()]} ${endDate.getFullYear()}`;
    return `${startStr} ‚Äì ${endStr}`;
  }

  function getFundingColor(type){
    if (type === 'industry') {
      return 'rgb(172, 14, 14)';
    } else if (type === 'academic') {
      return '#111827';
    } else {
      // government as default
      return 'rgb(214, 177, 77)';
    }
  }

  function getFundingLabel(type){
    if (type === 'industry') {
      return 'Industry-Funded';
    } else if (type === 'academic') {
      return 'Academic';
    } else {
      return 'Government-Funded';
    }
  }

  function byStartDesc(a,b){
    return parseStartDate(b.period) - parseStartDate(a.period);
  }

  function esc(s){
    return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  /* ===== DOM ===== */
  const qInput = document.getElementById('q');
  const grid = document.getElementById('grid');
  const count = document.getElementById('count');
  const fundingChips = document.getElementById('fundingChips');
  const statusChips = document.getElementById('statusChips');

  let q = "";

  /* ===== Build Filter Chips ===== */
  function buildChips(){
    fundingChips.innerHTML = FUNDING_TYPES.map(t => {
      const active = onFunding.has(t.value);
      return `<button class="chip ${active ? 'is-on':''}" data-funding="${t.value}" style="${active ? `background:${t.color};color:#fff` : ''}">
        ${t.label}
      </button>`;
    }).join('');

    statusChips.innerHTML = STATUSES.map(s => {
      const active = onStatus.has(s.value);
      return `<button class="chip ${active ? 'is-on':''}" data-status="${s.value}" style="${active ? `background:${s.color};color:#fff` : ''}">
        ${s.label}
      </button>`;
    }).join('');

    fundingChips.querySelectorAll('[data-funding]').forEach(btn=>{
      btn.onclick = () => {
        const v = btn.dataset.funding;
        onFunding.has(v) ? onFunding.delete(v) : onFunding.add(v);
        buildChips(); render();
      };
    });

    statusChips.querySelectorAll('[data-status]').forEach(btn=>{
      btn.onclick = () => {
        const v = btn.dataset.status;
        onStatus.has(v) ? onStatus.delete(v) : onStatus.add(v);
        buildChips(); render();
      };
    });
  }

  /* ===== Filtering ===== */
  function matchesQuery(project){
    if(!q) return true;
    const roles = project.roles || {};
    const rolesText = [roles.principalInvestigator, roles.leadResearcher, ...(roles.researchers||[])].filter(Boolean).join(' ');
    const keywordsText = (project.keywords||[]).join(' ');
    const fundingText = getFundingLabel(project.type);
    const statusText = computeStatus(project.period);
    const searchText = `${project.titleEn} ${project.titleKo} ${project.fundingAgency} ${rolesText} ${keywordsText} ${fundingText} ${statusText}`.toLowerCase();
    return searchText.includes(q.toLowerCase());
  }

  function passFunding(project){
    return onFunding.size ? onFunding.has(project.type) : true;
  }

  function passStatus(project){
    const s = computeStatus(project.period);
    return onStatus.size ? onStatus.has(s) : true;
  }

  function filterProjects(){
    return PROJECTS.filter(passFunding).filter(passStatus).filter(matchesQuery).sort(byStartDesc);
  }

  /* ===== Card ===== */
  function createCard(project){
    const fundingColor = getFundingColor(project.type);
    const fundingLabel = getFundingLabel(project.type);
    const periodFmt = formatPeriod(project.period);
    const status = computeStatus(project.period);

    const keywordBadges = (project.keywords||[]).map(k=>`<span class="badge">${esc(k)}</span>`).join('');
    const fundingBadge = `<span class="badge" style="border-color:${fundingColor};color:${fundingColor}">${fundingLabel}</span>`;
    const statusBadge = `<span class="badge" style="border-color:${status==='ongoing'?'#111827':'#9ca3af'};color:${status==='ongoing'?'#111827':'#6b7280'}">${status==='ongoing'?'Ongoing':'Completed'}</span>`;

    const r = project.roles || {};
    const pi = r.principalInvestigator ? esc(r.principalInvestigator) : '‚Äî';
    const lead= r.leadResearcher ? esc(r.leadResearcher) : '‚Äî';
    const res = (r.researchers && r.researchers.length) ? r.researchers.map(esc).join(', ') : '‚Äî';

    let outerClass;
    if (status === 'completed') {
      outerClass = 'card--completed';
    } else {
      // For ongoing projects, use type-specific classes
      if (project.type === 'industry') {
        outerClass = 'card--industry-ongoing';
      } else if (project.type === 'academic') {
        outerClass = 'card--academic-ongoing';
      } else {
        outerClass = 'card--government-ongoing';
      }
    }

    const notchColor = fundingColor;

    const agencyEn = project.fundingAgency || '';
    const agencyKo = project.fundingAgencyKo || '';
    
    const agencyValue = agencyKo
      ? `${esc(agencyEn)} <span class="ko-muted">¬∑ ${esc(agencyKo)}</span>`
      : esc(agencyEn);

    // Build meta items HTML - WITHOUT Amount
    let metaItemsHTML = `
      <div class="meta-item">
        <span class="meta-label">Period</span>
        <span class="meta-value">${esc(periodFmt)}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Funding Agency</span>
        <span class="meta-value">${agencyValue}</span>
      </div>`;
    
    // Check project type for role display
    if (project.type === 'academic') {
      // For academic projects, show only Lead Researcher and Researchers
      metaItemsHTML += `
      <div class="meta-item">
        <span class="meta-label">Lead Researcher</span>
        <span class="meta-value">${lead}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Researchers</span>
        <span class="meta-value">${res}</span>
      </div>`;
    } else if (r.principalInvestigator === 'ÏµúÏù∏Ïàò') {
      // If PI is ÏµúÏù∏Ïàò, show all three fields
      metaItemsHTML += `
      <div class="meta-item">
        <span class="meta-label">Principal Investigator</span>
        <span class="meta-value">${pi}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Lead Researcher</span>
        <span class="meta-value">${lead}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Researchers</span>
        <span class="meta-value">${res}</span>
      </div>`;
    } else {
      // If PI is not ÏµúÏù∏Ïàò, only show PI and Lead Researcher
      metaItemsHTML += `
      <div class="meta-item">
        <span class="meta-label">Principal Investigator</span>
        <span class="meta-value">${pi}</span>
      </div>
      <div class="meta-item">
        <span class="meta-label">Lead Researcher</span>
        <span class="meta-value">${lead}</span>
      </div>`;
    }

    return `<article class="card ${outerClass}">
      <div class="inner">
        <div class="type-notch" style="background:${notchColor}"></div>
        <div class="body">
          <div class="badges-status">
            ${fundingBadge}
            ${statusBadge}
          </div>
          <div class="badges-keywords">
            ${keywordBadges}
          </div>
          <div class="project-title-en">${esc(project.titleEn)}</div>
          <div class="project-title-ko"><span class="ko">${esc(project.titleKo)}</span></div>
          <div class="meta-info">
            ${metaItemsHTML}
          </div>
        </div>
      </div>
    </article>`;
  }

  /* ===== Render ===== */
  function render(){
    const data = filterProjects();
    if(data.length === 0){
      grid.innerHTML = `<div class="empty">No projects found. Try adjusting your search query or filters.</div>`;
    } else {
      grid.innerHTML = data.map(createCard).join('');
    }
    count.textContent = `${data.length} of ${PROJECTS.length}`;
  }

  /* ===== Init ===== */
  qInput.addEventListener('input', (e) => {
    q = e.target.value;
    render();
  });

  // Toggle filter section
  document.getElementById('toggleFilters').onclick = () => {
    const filterContent = document.getElementById('filterContent');
    const toggleBtn = document.getElementById('toggleFilters');
    const isHidden = filterContent.style.display === 'none';
    
    filterContent.style.display = isHidden ? 'block' : 'none';
    toggleBtn.textContent = isHidden ? 'Collapse' : 'Expand';
  };

  // Clear all filters
  document.getElementById('clearAllFilters').onclick = () => {
    onFunding.clear();
    onStatus.clear();
    qInput.value = '';
    q = '';
    buildChips();
    render();
  };

  // Calculate statistics (Amount Ï†úÍ±∞)
  function calculateStatistics() {
    let governmentCount = 0;
    let industryCount = 0;
    let academicCount = 0;

    PROJECTS.forEach(project => {
      // Count by type
      if (project.type === 'government') {
        governmentCount++;
      } else if (project.type === 'industry') {
        industryCount++;
      } else if (project.type === 'academic') {
        academicCount++;
      }
    });

    const totalCount = PROJECTS.length;

    // Update statistics display with animation
    animateNumber('governmentCount', governmentCount);
    animateNumber('industryCount', industryCount);
    animateNumber('academicCount', academicCount);
    animateNumber('totalCount', totalCount);
  }

  // Number animation effect
  function animateNumber(elementId, finalValue) {
    const el = document.getElementById(elementId);
    if (!el) return;
    
    const start = 0;
    const duration = 800;
    const startTime = performance.now();
    
    function tick(now) {
      const progress = Math.min(1, (now - startTime) / duration);
      const easeOutQuart = 1 - Math.pow(1 - progress, 4);
      const value = Math.round(start + (finalValue - start) * easeOutQuart);
      el.textContent = value;
      
      if (progress < 1) {
        requestAnimationFrame(tick);
      }
    }
    
    requestAnimationFrame(tick);
  }

  // Initialize
  buildChips();
  render();
  calculateStatistics();
})();
</script>
