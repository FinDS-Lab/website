<!-- Header / Global Nav -->
<header class="fixed-header">
  <div class="header-container">
    
    <!-- Brand -->
    <a href="{{ '/' | relative_url }}" class="brand-link" aria-label="FINDS Lab Home">
      <img src="{{ '/assets/img/brand/logo-finds.png' | relative_url }}" 
           alt="FINDS Lab Logo" 
           class="brand-logo" />
      <div class="brand-text">
        <div class="brand-name">FINDS Lab.</div>
        <div class="brand-subtitle">Dongduk Women's University</div>
      </div>
    </a>
    
    <!-- Desktop Nav -->
    <nav class="desktop-nav" aria-label="Primary">
      <a class="nav-link" href="{{ '/' | relative_url }}">Home</a>
      
      <!-- About -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/about-introduction.html' | relative_url }}">About FINDS</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/about-introduction.html' | relative_url }}">Introduction</a>
          <a href="{{ '/about-vision-area.html' | relative_url }}">Research Areas</a>
          <a href="{{ '/about-honors.html' | relative_url }}">Honors & Awards</a>
          <a href="{{ '/about-location.html' | relative_url }}">Location</a>
        </div>
      </div>
      
      <!-- Members -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/members-director.html' | relative_url }}">Members</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/members-director.html' | relative_url }}">Director</a>
          <a href="{{ '/members-current.html' | relative_url }}">Current Members</a>
          <a href="{{ '/members-alumni.html' | relative_url }}">Alumni</a>
        </div>
      </div>
      
      <a class="nav-link" href="{{ '/publications.html' | relative_url }}">Publications</a>
      <a class="nav-link" href="{{ '/lectures.html' | relative_url }}">Lectures</a>
      <a class="nav-link" href="{{ '/projects.html' | relative_url }}">Projects</a>
      
      <!-- Archives -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/archives-news.html' | relative_url }}">Archives</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/archives-news.html' | relative_url }}">News</a>
          <a href="{{ '/archives-notice.html' | relative_url }}">Notice</a>
          <a href="{{ '/archives-seminar.html' | relative_url }}">Seminar</a>
          <a href="{{ '/archives-gallery.html' | relative_url }}">Gallery</a>
        </div>
      </div>
    </nav>
    
    <!-- Mobile Toggle (Hamburger) -->
    <button id="btnMobile" 
            class="mobile-toggle" 
            aria-label="Menu" 
            aria-expanded="false" 
            aria-controls="mobileNav">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </div>
  
  <!-- Mobile Nav Dropdown -->
  <nav id="mobileNav" class="mobile-nav" aria-hidden="true">
    <div class="mobile-nav-inner">
      <a class="mobile-link" href="{{ '/' | relative_url }}">Home</a>
      
      <!-- About Section -->
      <div class="mobile-menu-section">
        <button class="mobile-section-header" aria-expanded="false" aria-controls="mob-about">
          <span>About FINDS</span>
          <svg class="chevron-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-about" class="mobile-submenu">
          <a href="{{ '/about-introduction.html' | relative_url }}">Introduction</a>
          <a href="{{ '/about-vision-area.html' | relative_url }}">Research Area</a>
          <a href="{{ '/about-honors.html' | relative_url }}">Honors & Awards</a>
          <a href="{{ '/about-location.html' | relative_url }}">Location</a>
        </div>
      </div>
      
      <!-- Members Section -->
      <div class="mobile-menu-section">
        <button class="mobile-section-header" aria-expanded="false" aria-controls="mob-members">
          <span>Members</span>
          <svg class="chevron-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-members" class="mobile-submenu">
          <a href="{{ '/members-director.html' | relative_url }}">Director</a>
          <a href="{{ '/members-current.html' | relative_url }}">Current Members</a>
          <a href="{{ '/members-alumni.html' | relative_url }}">Alumni</a>
        </div>
      </div>
      
      <a class="mobile-link" href="{{ '/publications.html' | relative_url }}">Publications</a>
      <a class="mobile-link" href="{{ '/lectures.html' | relative_url }}">Lectures</a>
      <a class="mobile-link" href="{{ '/projects.html' | relative_url }}">Projects</a>
      
      <!-- Archives Section -->
      <div class="mobile-menu-section">
        <button class="mobile-section-header" aria-expanded="false" aria-controls="mob-archives">
          <span>Archives</span>
          <svg class="chevron-icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-archives" class="mobile-submenu">
          <a href="{{ '/archives-news.html' | relative_url }}">News</a>
          <a href="{{ '/archives-notice.html' | relative_url }}">Notice</a>
          <a href="{{ '/archives-seminar.html' | relative_url }}">Seminar</a>
          <a href="{{ '/archives-gallery.html' | relative_url }}">Gallery</a>
        </div>
      </div>
    </div>
  </nav>
</header>

<style>
/* ========= Base Header Styles ========= */
.fixed-header {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 9999;
  background: rgba(214, 177, 77, 0.95);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(255,255,255,0.3);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.header-container {
  max-width: 1280px;
  margin: 0 auto;
  padding: 0 20px;
  height: 70px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
}

/* Mobile adjustments */
@media (max-width: 768px) {
  .header-container {
    height: 60px;
    padding: 0 16px;
  }
}

/* ========= Brand Styles ========= */
.brand-link {
  display: flex;
  align-items: center;
  gap: 12px;
  text-decoration: none;
  transition: transform 0.2s ease;
}

.brand-link:hover {
  transform: scale(1.02);
}

.brand-logo {
  height: 40px;
  width: 40px;
  border-radius: 10px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  background: white;
  object-fit: contain;
  padding: 2px;
}

.brand-text {
  line-height: 1.2;
}

.brand-name {
  font-size: 16px;
  font-weight: 900;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.2);
  letter-spacing: -0.3px;
}

.brand-subtitle {
  font-size: 11px;
  font-weight: 700;
  color: rgba(255,255,255,0.9);
  margin-top: 2px;
}

/* Mobile brand adjustments */
@media (max-width: 768px) {
  .brand-logo {
    height: 36px;
    width: 36px;
  }
  
  .brand-name {
    font-size: 15px;
  }
  
  .brand-subtitle {
    font-size: 10px;
  }
}

/* ========= Desktop Navigation ========= */
.desktop-nav {
  display: flex;
  align-items: center;
  gap: 8px;
}

@media (max-width: 1024px) {
  .desktop-nav {
    display: none;
  }
}

.nav-link {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 42px;
  padding: 0 16px;
  border-radius: 10px;
  font-weight: 800;
  font-size: 14px;
  color: white;
  text-shadow: 0 1px 2px rgba(0,0,0,0.15);
  text-decoration: none;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.nav-link:hover,
.menu-group:hover > .nav-link {
  background: rgba(255,255,255,0.2);
  transform: translateY(-1px);
}

.nav-link:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(255,255,255,0.5);
}

/* Dropdown menus */
.menu-group {
  position: relative;
}

.submenu-panel {
  display: none;
  position: absolute;
  top: calc(100% + 10px);
  left: 50%;
  transform: translateX(-50%);
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.15);
  min-width: 200px;
  padding: 8px;
  animation: slideDown 0.2s ease;
}

.menu-group:hover > .submenu-panel {
  display: block;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

.submenu-panel a {
  display: block;
  padding: 10px 14px;
  font-weight: 700;
  font-size: 13px;
  color: #374151;
  border-radius: 8px;
  text-decoration: none;
  transition: all 0.15s ease;
}

.submenu-panel a:hover {
  background: #fef3c7;
  color: #92400e;
  transform: translateX(2px);
}

/* ========= Mobile Toggle Button ========= */
.mobile-toggle {
  display: none;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 40px;
  height: 40px;
  padding: 0;
  background: rgba(255,255,255,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
}

@media (max-width: 1024px) {
  .mobile-toggle {
    display: flex;
  }
}

.mobile-toggle:hover {
  background: rgba(255,255,255,0.3);
}

.mobile-toggle:focus-visible {
  outline: none;
  box-shadow: 0 0 0 3px rgba(255,255,255,0.5);
}

/* Hamburger lines */
.hamburger-line {
  width: 22px;
  height: 2px;
  background: white;
  border-radius: 2px;
  transition: all 0.3s ease;
}

.hamburger-line:nth-child(2) {
  margin: 4px 0;
}

/* Animated hamburger */
.mobile-toggle[aria-expanded="true"] .hamburger-line:nth-child(1) {
  transform: translateY(6px) rotate(45deg);
}

.mobile-toggle[aria-expanded="true"] .hamburger-line:nth-child(2) {
  opacity: 0;
}

.mobile-toggle[aria-expanded="true"] .hamburger-line:nth-child(3) {
  transform: translateY(-6px) rotate(-45deg);
}

/* ========= Mobile Navigation ========= */
.mobile-nav {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: rgba(255,255,255,0.98);
  border-bottom: 1px solid rgba(214,177,77,0.2);
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

@media (max-width: 1024px) {
  .mobile-nav {
    display: block;
  }
}

.mobile-nav.is-open {
  max-height: calc(100vh - 60px);
  overflow-y: auto;
}

.mobile-nav-inner {
  padding: 12px 16px 20px;
  max-width: 600px;
  margin: 0 auto;
}

/* Mobile links */
.mobile-link {
  display: block;
  padding: 14px 16px;
  margin: 4px 0;
  font-weight: 800;
  font-size: 15px;
  color: #1f2937;
  text-decoration: none;
  border-radius: 10px;
  transition: all 0.2s ease;
}

.mobile-link:hover,
.mobile-link:focus {
  background: #fef3c7;
  color: #92400e;
  transform: translateX(4px);
}

/* Mobile menu sections */
.mobile-menu-section {
  margin: 4px 0;
}

.mobile-section-header {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  background: transparent;
  border: none;
  border-radius: 10px;
  font-weight: 800;
  font-size: 15px;
  color: #1f2937;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s ease;
}

.mobile-section-header:hover,
.mobile-section-header:focus {
  background: #fef3c7;
  color: #92400e;
  outline: none;
}

.chevron-icon {
  width: 20px;
  height: 20px;
  transition: transform 0.3s ease;
  flex-shrink: 0;
}

.mobile-section-header[aria-expanded="true"] .chevron-icon {
  transform: rotate(180deg);
}

/* Mobile submenus */
.mobile-submenu {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  margin-left: 16px;
}

.mobile-submenu.is-open {
  max-height: 400px;
}

.mobile-submenu a {
  display: block;
  padding: 10px 16px;
  margin: 2px 0;
  font-weight: 700;
  font-size: 14px;
  color: #4b5563;
  text-decoration: none;
  border-radius: 8px;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
}

.mobile-submenu a:hover,
.mobile-submenu a:focus {
  background: #fef3c7;
  color: #92400e;
  border-left-color: #d97706;
  padding-left: 20px;
}

/* Smooth scrolling for mobile */
@media (max-width: 1024px) {
  .mobile-nav {
    -webkit-overflow-scrolling: touch;
  }
}

/* Prevent body scroll when mobile menu is open */
body.mobile-menu-open {
  overflow: hidden;
  position: fixed;
  width: 100%;
}

/* Small mobile adjustments */
@media (max-width: 480px) {
  .mobile-link,
  .mobile-section-header {
    font-size: 14px;
    padding: 12px 14px;
  }
  
  .mobile-submenu a {
    font-size: 13px;
    padding: 8px 14px;
  }
  
  .mobile-nav-inner {
    padding: 10px 12px 16px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const btnMobile = document.getElementById('btnMobile');
  const mobileNav = document.getElementById('mobileNav');
  const body = document.body;
  
  // Toggle mobile menu
  btnMobile.addEventListener('click', function() {
    const isOpen = mobileNav.classList.contains('is-open');
    
    if (isOpen) {
      closeMobileMenu();
    } else {
      openMobileMenu();
    }
  });
  
  function openMobileMenu() {
    mobileNav.classList.add('is-open');
    btnMobile.setAttribute('aria-expanded', 'true');
    mobileNav.setAttribute('aria-hidden', 'false');
    body.classList.add('mobile-menu-open');
  }
  
  function closeMobileMenu() {
    mobileNav.classList.remove('is-open');
    btnMobile.setAttribute('aria-expanded', 'false');
    mobileNav.setAttribute('aria-hidden', 'true');
    body.classList.remove('mobile-menu-open');
    
    // Close all submenus
    document.querySelectorAll('.mobile-submenu').forEach(submenu => {
      submenu.classList.remove('is-open');
    });
    document.querySelectorAll('.mobile-section-header').forEach(btn => {
      btn.setAttribute('aria-expanded', 'false');
    });
  }
  
  // Handle submenu toggles
  document.querySelectorAll('.mobile-section-header').forEach(button => {
    button.addEventListener('click', function() {
      const submenuId = this.getAttribute('aria-controls');
      const submenu = document.getElementById(submenuId);
      const isOpen = submenu.classList.contains('is-open');
      
      // Close all other submenus
      document.querySelectorAll('.mobile-submenu').forEach(menu => {
        if (menu.id !== submenuId) {
          menu.classList.remove('is-open');
        }
      });
      document.querySelectorAll('.mobile-section-header').forEach(btn => {
        if (btn !== this) {
          btn.setAttribute('aria-expanded', 'false');
        }
      });
      
      // Toggle current submenu
      if (isOpen) {
        submenu.classList.remove('is-open');
        this.setAttribute('aria-expanded', 'false');
      } else {
        submenu.classList.add('is-open');
        this.setAttribute('aria-expanded', 'true');
      }
    });
  });
  
  // Close menu when clicking outside
  document.addEventListener('click', function(event) {
    if (!event.target.closest('.fixed-header') && mobileNav.classList.contains('is-open')) {
      closeMobileMenu();
    }
  });
  
  // Close menu on escape key
  document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape' && mobileNav.classList.contains('is-open')) {
      closeMobileMenu();
      btnMobile.focus();
    }
  });
  
  // Handle window resize
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      if (window.innerWidth > 1024 && mobileNav.classList.contains('is-open')) {
        closeMobileMenu();
      }
    }, 250);
  });
});
</script>
