<!-- Header / Global Nav -->
<header class="fixed-header" style="position: fixed; top: 0; left: 0; right: 0; z-index: 9999; background: rgba(214, 177, 77, 0.92); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(255,255,255,0.4); box-shadow: 0 2px 4px rgba(0,0,0,0.1); height: 70px;">
  <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-between gap-4">
    
    <!-- Brand -->
    <a href="{{ '/' | relative_url }}" class="flex items-center gap-3 group" aria-label="FINDS Lab Home">
      <img src="{{ '/assets/img/brand/logo-finds.png' | relative_url }}" 
           alt="FINDS Lab Logo" 
           class="h-10 w-10 rounded-lg ring-2 ring-white/50 object-contain bg-white shadow-sm transition-transform group-hover:scale-105" />
      <div class="leading-tight">
        <div class="text-sm font-extrabold tracking-tight text-white drop-shadow-sm">FINDS Lab.</div>
        <div class="text-[11px] font-bold text-white/90 tracking-wide">Dongduk Women's University</div>
      </div>
    </a>
    
    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-6" aria-label="Primary">
      <a class="nav-link" href="{{ '/' | relative_url }}">Home</a>
      
      <!-- About -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/about-introduction.html' | relative_url }}">About FINDS</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/about-introduction.html' | relative_url }}">Introduction</a>
          <a href="{{ '/about-vision-area.html' | relative_url }}">Research Areas</a>
          <a href="{{ '/about-honors.html' | relative_url }}">Honors & Awards</a>
          <a href="{{ '/about-location.html' | relative_url }}">Location</a>
        </div>
      </div>
      
      <!-- Members -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/members-director.html' | relative_url }}">Members</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/members-director.html' | relative_url }}">Director</a>
          <a href="{{ '/members-current.html' | relative_url }}">Current Members</a>
          <a href="{{ '/members-alumni.html' | relative_url }}">Alumni</a>
        </div>
      </div>
      
      <a class="nav-link" href="{{ '/publications.html' | relative_url }}">Publications</a>
      <a class="nav-link" href="{{ '/lectures.html' | relative_url }}">Lectures</a>
      <a class="nav-link" href="{{ '/projects.html' | relative_url }}">Projects</a>
      
      <!-- Archives -->
      <div class="menu-group" data-menu>
        <a class="nav-link" href="{{ '/archives-news.html' | relative_url }}">Archives</a>
        <div class="submenu-panel" role="menu">
          <a href="{{ '/archives-news.html' | relative_url }}">News</a>
          <a href="{{ '/archives-notice.html' | relative_url }}">Notice</a>
          <a href="{{ '/archives-seminar.html' | relative_url }}">Seminar</a>
          <a href="{{ '/archives-gallery.html' | relative_url }}">Gallery</a>
          <a href="{{ '/archives-gallery.html' | relative_url }}">Playlist</a>
        </div>
      </div>
    </nav>
    
    <!-- Mobile Toggle -->
    <div class="flex items-center gap-2 md:hidden">
      <button id="btnMobile" 
              class="mobile-menu-btn" 
              aria-label="Open menu" 
              aria-expanded="false" 
              aria-controls="mobileNav">
        <span class="hamburger-box">
          <span class="hamburger-inner"></span>
        </span>
      </button>
    </div>
  </div>
  
  <!-- Mobile Nav - 완전히 새로운 구조 -->
  <div id="mobileNav" class="mobile-nav-container">
    <div class="mobile-nav-content">
      <a class="mobile-link" href="{{ '/' | relative_url }}">Home</a>
      
      <!-- About (Accordion) -->
      <div class="mobile-accordion">
        <button class="accordion-trigger" data-target="mob-about">
          <span>About FINDS</span>
          <svg class="accordion-icon" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-about" class="accordion-content">
          <a href="{{ '/about-introduction.html' | relative_url }}">Introduction</a>
          <a href="{{ '/about-vision-area.html' | relative_url }}">Research Area</a>
          <a href="{{ '/about-honors.html' | relative_url }}">Honors & Awards</a>
          <a href="{{ '/about-location.html' | relative_url }}">Location</a>
        </div>
      </div>
      
      <!-- Members (Accordion) -->
      <div class="mobile-accordion">
        <button class="accordion-trigger" data-target="mob-members">
          <span>Members</span>
          <svg class="accordion-icon" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-members" class="accordion-content">
          <a href="{{ '/members-director.html' | relative_url }}">Director</a>
          <a href="{{ '/members-current.html' | relative_url }}">Current Members</a>
          <a href="{{ '/members-alumni.html' | relative_url }}">Alumni</a>
        </div>
      </div>
      
      <a class="mobile-link" href="{{ '/publications.html' | relative_url }}">Publications</a>
      <a class="mobile-link" href="{{ '/lectures.html' | relative_url }}">Lectures</a>
      <a class="mobile-link" href="{{ '/projects.html' | relative_url }}">Projects</a>
      
      <!-- Archives (Accordion) -->
      <div class="mobile-accordion">
        <button class="accordion-trigger" data-target="mob-archives">
          <span>Archives</span>
          <svg class="accordion-icon" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/>
          </svg>
        </button>
        <div id="mob-archives" class="accordion-content">
          <a href="{{ '/archives-news.html' | relative_url }}">News</a>
          <a href="{{ '/archives-notice.html' | relative_url }}">Notice</a>
          <a href="{{ '/archives-seminar.html' | relative_url }}">Seminar</a>
          <a href="{{ '/archives-gallery.html' | relative_url }}">Gallery</a>
        </div>
      </div>
    </div>
  </div>
</header>

<style>
/* ========= 기존 데스크톱 스타일 유지 ========= */
.nav-link{
  display:inline-flex; align-items:center; justify-content:center;
  height:46px; padding:0 14px; border-radius:10px;
  font-weight:800; line-height:1;
  color:#ffffff;
  text-shadow: 0 1px 1px rgba(0,0,0,.18);
  transition: background-color .2s ease, color .2s ease, box-shadow .2s ease, transform .2s ease;
}

.nav-link:hover,
.menu-group:hover > .nav-link{
  color:#ffffff;
  background: rgba(0,0,0,.15);
  text-shadow: 0 2px 6px rgba(0,0,0,.35);
}

.nav-link:focus-visible{
  outline: none;
  color:#ffffff;
  background: rgba(0,0,0,.20);
  text-shadow: 0 2px 6px rgba(0,0,0,.35);
  box-shadow: 0 0 0 3px rgba(255,255,255,.45);
}

.menu-group{ position:relative; }
.submenu-panel{
  display:none; position:absolute; top:calc(100% + 8px); left:0;
  background:#fff; border:1px solid rgba(0,0,0,.08); border-radius:12px;
  box-shadow:0 12px 40px rgba(0,0,0,.12);
  min-width:180px; padding:8px 0; z-index:50;
}
.menu-group:hover > .submenu-panel,
.menu-group[data-open="true"] > .submenu-panel{ display:block; }

.submenu-panel a{
  display:block; padding:8px 14px; font-weight:700; font-size:14px;
  color:#1f2937; border-radius:8px; transition: background-color .15s ease, color .15s ease;
}
.submenu-panel a:hover{
  background:#fff7e0;
  color:#8a6a12;
}

/* ========= 모바일 헤더 높이 조정 ========= */
@media (max-width: 768px) {
  .fixed-header {
    height: 60px !important;
  }
  
  .fixed-header > div:first-child {
    height: 60px !important;
  }
  
  .fixed-header img {
    height: 36px !important;
    width: 36px !important;
  }
  
  .fixed-header .text-sm {
    font-size: 14px !important;
  }
  
  .fixed-header .text-\\[11px\\] {
    font-size: 10px !important;
  }
}

/* ========= 햄버거 메뉴 버튼 새로운 스타일 ========= */
.mobile-menu-btn {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  padding: 0;
  background: rgba(255,255,255,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  overflow: hidden;
}

.mobile-menu-btn:hover {
  background: rgba(255,255,255,0.3);
}

.hamburger-box {
  width: 24px;
  height: 18px;
  display: inline-block;
  position: relative;
}

.hamburger-inner {
  display: block;
  top: 50%;
  margin-top: -1px;
}

.hamburger-inner,
.hamburger-inner::before,
.hamburger-inner::after {
  width: 24px;
  height: 2px;
  background-color: #fff;
  border-radius: 2px;
  position: absolute;
  transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.hamburger-inner::before,
.hamburger-inner::after {
  content: "";
  display: block;
}

.hamburger-inner::before {
  top: -6px;
}

.hamburger-inner::after {
  bottom: -6px;
}

/* 햄버거 → X 애니메이션 */
.mobile-menu-btn.is-active .hamburger-inner {
  transform: rotate(45deg);
}

.mobile-menu-btn.is-active .hamburger-inner::before {
  top: 0;
  opacity: 0;
}

.mobile-menu-btn.is-active .hamburger-inner::after {
  bottom: 0;
  transform: rotate(-90deg);
}

/* ========= 모바일 네비게이션 컨테이너 ========= */
.mobile-nav-container {
  display: none;
  position: fixed;
  top: 60px;
  left: 0;
  right: 0;
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid rgba(214, 177, 77, 0.2);
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 9998;
}

@media (max-width: 768px) {
  .mobile-nav-container {
    display: block;
  }
}

.mobile-nav-container.is-open {
  max-height: calc(100vh - 60px);
  overflow-y: auto;
}

.mobile-nav-content {
  padding: 16px;
  max-width: 500px;
  margin: 0 auto;
}

/* ========= 모바일 링크 스타일 ========= */
.mobile-link {
  display: block;
  padding: 14px 16px;
  margin-bottom: 8px;
  font-weight: 700;
  font-size: 15px;
  color: #1f2937;
  text-decoration: none;
  background: transparent;
  border-radius: 10px;
  transition: all 0.2s ease;
}

.mobile-link:hover,
.mobile-link:active {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  color: #92400e;
  transform: translateX(4px);
}

/* ========= 모바일 아코디언 스타일 ========= */
.mobile-accordion {
  margin-bottom: 8px;
}

.accordion-trigger {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px;
  background: transparent;
  border: none;
  border-radius: 10px;
  font-weight: 700;
  font-size: 15px;
  color: #1f2937;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s ease;
}

.accordion-trigger:hover,
.accordion-trigger:active {
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  color: #92400e;
}

.accordion-icon {
  transition: transform 0.3s ease;
  flex-shrink: 0;
}

.accordion-trigger.is-open .accordion-icon {
  transform: rotate(180deg);
}

.accordion-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  padding-left: 16px;
}

.accordion-content.is-open {
  max-height: 400px;
  padding-top: 4px;
  padding-bottom: 4px;
}

.accordion-content a {
  display: block;
  padding: 10px 16px;
  margin: 4px 0;
  font-weight: 600;
  font-size: 14px;
  color: #4b5563;
  text-decoration: none;
  border-radius: 8px;
  border-left: 3px solid transparent;
  transition: all 0.2s ease;
}

.accordion-content a:hover,
.accordion-content a:active {
  background: #fef3c7;
  color: #92400e;
  border-left-color: #d97706;
  padding-left: 20px;
}

/* 바디 스크롤 방지 */
body.menu-open {
  overflow: hidden;
  position: fixed;
  width: 100%;
}

/* 스크롤바 스타일 (모바일) */
@media (max-width: 768px) {
  .mobile-nav-container::-webkit-scrollbar {
    width: 4px;
  }
  
  .mobile-nav-container::-webkit-scrollbar-thumb {
    background: rgba(214, 177, 77, 0.3);
    border-radius: 2px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const btnMobile = document.getElementById('btnMobile');
  const mobileNav = document.getElementById('mobileNav');
  const body = document.body;
  
  // 햄버거 메뉴 토글
  btnMobile.addEventListener('click', function(e) {
    e.stopPropagation();
    const isOpen = this.classList.contains('is-active');
    
    if (isOpen) {
      closeMenu();
    } else {
      openMenu();
    }
  });
  
  function openMenu() {
    btnMobile.classList.add('is-active');
    btnMobile.setAttribute('aria-expanded', 'true');
    mobileNav.classList.add('is-open');
    body.classList.add('menu-open');
  }
  
  function closeMenu() {
    btnMobile.classList.remove('is-active');
    btnMobile.setAttribute('aria-expanded', 'false');
    mobileNav.classList.remove('is-open');
    body.classList.remove('menu-open');
    
    // 모든 아코디언 닫기
    document.querySelectorAll('.accordion-trigger').forEach(trigger => {
      trigger.classList.remove('is-open');
    });
    document.querySelectorAll('.accordion-content').forEach(content => {
      content.classList.remove('is-open');
    });
  }
  
  // 아코디언 토글
  document.querySelectorAll('.accordion-trigger').forEach(trigger => {
    trigger.addEventListener('click', function(e) {
      e.stopPropagation();
      const targetId = this.getAttribute('data-target');
      const content = document.getElementById(targetId);
      const isOpen = this.classList.contains('is-open');
      
      // 다른 아코디언 닫기
      document.querySelectorAll('.accordion-trigger').forEach(t => {
        if (t !== this) t.classList.remove('is-open');
      });
      document.querySelectorAll('.accordion-content').forEach(c => {
        if (c !== content) c.classList.remove('is-open');
      });
      
      // 현재 아코디언 토글
      if (isOpen) {
        this.classList.remove('is-open');
        content.classList.remove('is-open');
      } else {
        this.classList.add('is-open');
        content.classList.add('is-open');
      }
    });
  });
  
  // 외부 클릭 시 메뉴 닫기
  document.addEventListener('click', function(e) {
    if (!e.target.closest('.fixed-header') && mobileNav.classList.contains('is-open')) {
      closeMenu();
    }
  });
  
  // ESC 키로 메뉴 닫기
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && mobileNav.classList.contains('is-open')) {
      closeMenu();
      btnMobile.focus();
    }
  });
  
  // 윈도우 리사이즈 처리
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(function() {
      if (window.innerWidth > 768 && mobileNav.classList.contains('is-open')) {
        closeMenu();
      }
    }, 250);
  });
  
  // 링크 클릭 시 메뉴 닫기
  document.querySelectorAll('.mobile-link, .accordion-content a').forEach(link => {
    link.addEventListener('click', function() {
      closeMenu();
    });
  });
});
</script>
