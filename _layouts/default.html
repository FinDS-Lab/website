<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ page.description | default: site.description }}" />
  <meta name="theme-color" content="#ffffff" />
  <link rel="icon" href="{{ '/assets/img/favicon.ico' | relative_url }}"/>

  {%- comment -%}
    OG/Twitter 이미지 결정 로직
    1) 페이지가 front matter에서 og_image 지정하면 우선
    2) 없으면 전역 site.og_image 사용
    절대 URL 보장을 위해 site.url + site.baseurl + 경로를 합칩니다.
  {%- endcomment -%}
  {%- assign og_img_src = page.og_image | default: site.og_image -%}
  {%- if og_img_src contains 'http' -%}
    {%- assign og_img_abs = og_img_src -%}
  {%- else -%}
    {%- assign og_img_abs = site.url | append: site.baseurl | append: og_img_src -%}
  {%- endif -%}

  {%- comment -%}
    현재 페이지의 정규 URL(og:url, canonical)
  {%- endcomment -%}
  {%- assign page_abs_url = site.url | append: site.baseurl | append: page.url -%}

  <!-- Canonical -->
  <link rel="canonical" href="{{ page_abs_url }}"/>

  <!-- Open Graph -->
  <meta property="og:locale" content="ko_KR" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="{{ site.title }}" />
  <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}" />
  <meta property="og:description" content="{{ page.description | default: site.description }}" />
  <meta property="og:url" content="{{ page_abs_url }}" />
  <meta property="og:image" content="{{ og_img_abs }}?v={{ site.asset_version }}" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}" />
  <meta name="twitter:description" content="{{ page.description | default: site.description }}" />
  <meta name="twitter:image" content="{{ og_img_abs }}?v={{ site.asset_version }}" />

  {%- comment -%}
    (선택) jekyll-seo-tag 사용 시 아래 한 줄 활성화하면
    title/description/canonical 등 자동 보강됩니다.
    단, og:image는 위에서 이미 설정했으니 둘 다 써도 문제 없습니다.
  {%- endcomment -%}
  {%- comment -%} {% seo %} {%- endcomment -%}

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;900&family=Noto+Sans:wght@400;600;700;900&family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        container: { center: true, screens: { xl: '72rem' } },
        extend: {
          fontFamily: {
            sans: ['Noto Sans KR','Noto Sans','Roboto','ui-sans-serif','system-ui','Apple SD Gothic Neo','Apple Color Emoji','Segoe UI Emoji']
          }
        }
      }
    }
  </script>

  <!-- Site CSS -->
  <link rel="preload" as="style" href="{{ '/assets/css/site.css' | relative_url }}">
  <link rel="stylesheet" href="{{ '/assets/css/site.css' | relative_url }}">

  <!-- (선택) Google Analytics 4 -->
  {% comment %}
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXYYYYZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-XXXXXYYYYZ');
  </script>
  {% endcomment %}

  <!-- 전역 레이아웃 보정 -->
  <style>
    :root{
      --header-height: 70px;
      --accent: rgb(214, 177, 77);
      --accent2: rgb(172, 14, 14);
    }
    body{
      padding-top: var(--header-height);
      margin:0;
    }
    @media (max-width: 768px){
      :root{ --header-height: 60px; }
    }
    .skip-link {
      position: absolute; left: -9999px; top: auto; width: 1px; height: 1px; overflow: hidden;
    }
    .skip-link:focus {
      left: 16px; top: calc(var(--header-height) + 10px);
      width: auto; height: auto; z-index: 10000;
      background: #fff; color: #111; padding: .5rem .75rem; border-radius: .5rem;
      border: 1px solid #e5e7eb; box-shadow: 0 4px 12px rgba(0,0,0,.1);
    }
    main{
      position: relative; z-index: 1;
      min-height: calc(100vh - var(--header-height));
    }
    main > .main-container { padding: 0; }
    main > .main-container.page-container { padding: 2rem 1rem; }
    .content-offset{ scroll-margin-top: calc(var(--header-height) + 20px); }
    header .submenu-panel { display: none; }
    header .menu-group:hover .submenu-panel,
    header [data-menu][data-open="true"] .submenu-panel { display: block; }
    .site-header, header{ position: sticky; top: 0; z-index: 1000; }
    .hero-section, .carousel-container, .carousel-overlay{ z-index: 0; }
    @media (prefers-reduced-motion: reduce){
      *{ animation-duration:.001ms !important; animation-iteration-count:1 !important; transition-duration:.001ms !important; scroll-behavior:auto !important; }
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900 antialiased min-h-screen flex flex-col">
  <!-- Skip to content -->
  <a href="#main" class="skip-link">본문으로 건너뛰기</a>

  <!-- Header -->
  {% include header.html %}

  <!-- Main -->
  <main id="main" class="content-offset grow">
    {% if page.url == "/" or page.url == "/index.html" %}
      <div class="main-container max-w-7xl mx-auto">
        {{ content }}
      </div>
    {% else %}
      <div class="main-container page-container max-w-7xl mx-auto">
        {{ content }}
      </div>
    {% endif %}
  </main>

  <!-- Footer -->
  {% include footer.html %}

  <!-- Site JS -->
  <script defer src="{{ '/assets/js/site.js' | relative_url }}"></script>

  <!-- 헤더 보조 스크립트 -->
  <script>
    (function () {
      var prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
      if (!prefersReducedMotion.matches && 'scrollBehavior' in document.documentElement.style) {
        document.documentElement.style.scrollBehavior = 'smooth';
      }
      if (window.location.hash) {
        setTimeout(function() {
          var target = document.querySelector(window.location.hash);
          if (target) {
            var headerH = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--header-height')) || 70;
            var top = target.getBoundingClientRect().top + window.pageYOffset - headerH - 20;
            window.scrollTo(0, top);
          }
        }, 100);
      }
    })();
  </script>
</body>
</html>
