const W=i=>{const p=/^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/,n=i.match(p);if(!n)return{data:{},content:i};const t=n[1],h=n[2],l={};return t.split(`
`).forEach(g=>{const c=g.indexOf(":");if(c>-1){const o=g.slice(0,c).trim();let s=g.slice(c+1).trim();s.startsWith("[")&&s.endsWith("]")?l[o]=s.slice(1,-1).split(",").map(_=>_.trim()):(s.startsWith('"')&&s.endsWith('"')&&(s=s.slice(1,-1)),l[o]=s)}}),{data:l,content:h}},$=(i,p)=>{if(!i)return"";const n=new Date(i);if(isNaN(n.getTime()))return i;const t=n.getFullYear(),h=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return p.replace("%Y",String(t)).replace("%m",h).replace("%d",l).replace("%B",n.toLocaleString("en",{month:"long"})).replace("%b",n.toLocaleString("en",{month:"short"}))},d=(i,p)=>{const n=p?.basePath||"";let t=i;const h=[];t=t.replace(/```(\w*)\n([\s\S]*?)```/g,(e,r,a)=>{const f=r?` class="language-${r}"`:"",m=`___CODEBLOCK_${h.length}___`;return h.push(`<pre><code${f}>${a.replace(/</g,"&lt;").replace(/>/g,"&gt;").trim()}</code></pre>`),m});const l=[];t=t.replace(/`([^`]+)`/g,(e,r)=>{const a=`___INLINECODE_${l.length}___`;return l.push(`<code>${r}</code>`),a}),t=t.replace(/!\[([^\]]*)\]\(([^)"]+)(?:\s+"([^"]*)")?\)/g,(e,r,a,f)=>{let m=a;!a.startsWith("http://")&&!a.startsWith("https://")&&!a.startsWith("data:")&&(a.startsWith("/")&&n?m=n+a:a.startsWith("../")||a.startsWith("./")?m=n+"/"+a.replace(/^\.\//,""):m=n+"/"+a);const u=f?` title="${f}"`:"";return`<img src="${m}" alt="${r}"${u} />`}),t=t.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>'),t=t.replace(/^#### (.+)$/gm,"<h4>$1</h4>"),t=t.replace(/^### (.+)$/gm,"<h3>$1</h3>"),t=t.replace(/^## (.+)$/gm,"<h2>$1</h2>"),t=t.replace(/^# (.+)$/gm,"<h1>$1</h1>"),t=t.replace(/^[-*]{3,}\s*$/gm,"<hr />");const g=t.split(`
`),c=[];let o=!1,s=!1;for(let e=0;e<g.length;e++){const r=g[e],a=r.match(/^- (.+)$/);if(a){o||(c.push("<ul>"),o=!0),c.push(`<li>${a[1]}</li>`);continue}else o&&!r.match(/^- /)&&(c.push("</ul>"),o=!1);const f=r.match(/^\d+\. (.+)$/);if(f){s||(c.push("<ol>"),s=!0),c.push(`<li>${f[1]}</li>`);continue}else s&&!r.match(/^\d+\. /)&&(c.push("</ol>"),s=!1);c.push(r)}return o&&c.push("</ul>"),s&&c.push("</ol>"),t=c.join(`
`),t=t.replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/__(.+?)__/g,"<strong>$1</strong>"),t=t.replace(/\*(.+?)\*/g,"<em>$1</em>"),t=t.replace(/\b_(.+?)_\b/g,"<em>$1</em>"),t=t.replace(/^> (.+)$/gm,"<blockquote>$1</blockquote>"),t=t.replace(/<\/blockquote>\n<blockquote>/g,"<br />"),t=t.split(/\n\n+/).map(e=>(e=e.trim(),e?e.startsWith("<h")||e.startsWith("<ul")||e.startsWith("<ol")||e.startsWith("<blockquote")||e.startsWith("<pre")||e.startsWith("<hr")||e.startsWith("<img")||e.startsWith("<p")||e.startsWith("___CODEBLOCK")||e.startsWith("<li")?e:`<p>${e.replace(/\n/g,"<br />")}</p>`:"")).join(`
`),h.forEach((e,r)=>{t=t.replace(`___CODEBLOCK_${r}___`,e)}),l.forEach((e,r)=>{t=t.replace(`___INLINECODE_${r}___`,e)}),t},b=(i,p,n)=>{let t=i;const h=n?.basePath||"",l=/\{\{\s*page\.(\w+)(?:\s*\|\s*([^}]+))?\s*\}\}/g;return t=t.replace(l,(g,c,o)=>{let s=p[c];if(Array.isArray(s)&&(s=s.join(", ")),!o)return s||"";const _=o.split("|").map(e=>e.trim());for(const e of _){const r=e.match(/^date:\s*"([^"]+)"/);if(r){s=$(s||"",r[1]);continue}const a=e.match(/^default:\s*"([^"]*)"/);if(a){(!s||s==="")&&(s=a[1]);continue}if(e==="relative_url"){s&&typeof s=="string"&&(s=h+s);continue}}return s||""}),t=t.replace(/\{\{\s*site\.[^}]*\}\}/g,""),t=d(t,{basePath:h}),t};export{b as a,W as p};
